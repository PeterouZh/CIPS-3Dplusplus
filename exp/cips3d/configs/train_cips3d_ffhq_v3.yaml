root_obs: &root_obs s3://bucket-3690/ZhouPeng

network_pkl: &network_pkl
  "ffhq_r1024_inversion": "pretrained/ffhq_r1024_inversion"
  "disney_r1024": "pretrained/disney_r1024"
  "photo2cartoon_r1024": "pretrained/photo2cartoon_r1024"
  "ffhq_r1024": "pretrained/ffhq_r1024"
  "ffhq_r512": "pretrained/ffhq_r512"
  "carla_r256": "pretrained/carla_r256"

  obs_inception_v3: &obs_inception_v3
  datapath_obs: 'keras/cache/torch/hub/checkpoints/weights-inception-2015-12-05-6726825d.pth'
  datapath: "~/.cache/torch/hub/checkpoints/weights-inception-2015-12-05-6726825d.pth"
  disable: false
  overwrite: false
  unzip: false


obs_ffhq_r1024: &obs_ffhq_r1024
  datapath_obs: 'keras/ffhq/images1024x1024_lmdb_1024/'
  datapath: "datasets/ffhq/images1024x1024_lmdb_1024/"
  disable: false
  overwrite: false
  unzip: false

obs_ffhq_r512: &obs_ffhq_r512
  datapath_obs: 'keras/ffhq/images1024x1024_lmdb_512/'
  datapath: "datasets/ffhq/images1024x1024_lmdb_512/"
  disable: false
  overwrite: false
  unzip: false

obs_ffhq_r256: &obs_ffhq_r256
  datapath_obs: 'keras/ffhq/images1024x1024_lmdb_256/'
  datapath: "datasets/ffhq/images1024x1024_lmdb_256/"
  disable: false
  overwrite: false
  unzip: false

obs_ffhq_r128: &obs_ffhq_r128
  datapath_obs: 'keras/ffhq/images1024x1024_lmdb_128/'
  datapath: "datasets/ffhq/images1024x1024_lmdb_128/"
  disable: false
  overwrite: false
  unzip: false

obs_ffhq_r64: &obs_ffhq_r64
  datapath_obs: 'keras/ffhq/images1024x1024_lmdb_64/'
  datapath: "datasets/ffhq/images1024x1024_lmdb_64/"
  disable: false
  overwrite: false
  unzip: false

obs_afhq_r1024: &obs_afhq_r1024
  datapath_obs: 'keras/AFHQv2/AFHQv2_lmdb_1024/'
  datapath: "datasets/AFHQv2/AFHQv2_lmdb_1024/"
  disable: false
  overwrite: false
  unzip: false

obs_metfaces_r1024: &obs_metfaces_r1024
  datapath_obs: 'keras/MetFaces/images_1024_lmdb_1024'
  datapath: "datasets/MetFaces/images_1024_lmdb_1024"
  disable: false
  overwrite: false
  unzip: false

obs_bitmojifaces_r1024: &obs_bitmojifaces_r1024
  datapath_obs: 'keras/Faces/BitmojiFaces/BitmojiDataset_lmdb_1024'
  datapath: "datasets/Faces/BitmojiFaces/BitmojiDataset_lmdb_1024"
  disable: false
  overwrite: false
  unzip: false

obs_disney_r1024: &obs_disney_r1024
  datapath_obs: 'keras/Disney_cartoon/cartoon_lmdb_1024'
  datapath: "datasets/Disney_cartoon/cartoon_lmdb_1024"
  disable: false
  overwrite: false
  unzip: false

obs_photo2cartoon_r1024: &obs_photo2cartoon_r1024
  datapath_obs: 'keras/Faces/photo2cartoon/photo2cartoon_lmdb_1024'
  datapath: "datasets/Faces/photo2cartoon/photo2cartoon_lmdb_1024"
  disable: false
  overwrite: false
  unzip: false


G_cfg: &G_cfg
  register_modules:
    - "exp.cips3d.models.model_v3"
  name: "exp.cips3d.models.model_v3.Generator"
  enable_decoder: true
  freeze_renderer: false
  renderer_detach: true
  predict_rgb_residual: false
  scale_factor: 1
  renderer_cfg:
#    N_layers_renderer: 8
    N_layers_renderer: 2
    input_dim: 3
    hidden_dim: 256
#    style_dim: 256
    view_dim: 3
    with_sdf: true
    output_features : true
  mapping_renderer_cfg:
    z_dim: 256
    style_dim: 256
    N_layers: 3
  decoder_cfg:
    size_start: 4
    size_end: 1024
#    'style_dim': 512
    'in_channel': 256
    'channel_multiplier': 2
    'project_noise': False
    'upsample_list': [128, 256, 512, 1024]
#    'upsample_list': []
    'kernel_size': 1
  mapping_decoder_cfg:
#    z_dim: 256
    style_dim: 512
    lr_mul_mapping: 0.01
    N_layers: 5


G_kwargs: &G_kwargs
  cam_cfg:
    'img_size': 64
    'uniform': False
    'azim_range': 0.3
    'elev_range': 0.15
    'fov_ang': 6
    'dist_radius': 0.12
  nerf_cfg:
    N_samples: 24
    perturb: true
    static_viewdirs: false

_build_generator:
  G_cfg: *G_cfg
  G_kwargs: *G_kwargs

D_cfg: &D_cfg
  register_modules:
    - "exp.cips3d.models.discriminator"
  name: "exp.cips3d.models.discriminator.D_StyleGAN_Progressive"
  input_size: 1024
  channel_multiplier: 2
  pretrained_size: null

D_renderer_cfg: &D_renderer_cfg
  register_modules:
    - "exp.cips3d.models.discriminator_pose"
  name: "exp.cips3d.models.discriminator_pose.D_VolumeRender_Progressive"
  input_size: 1024
  viewpoint_loss: true
  pretrained_size: null

train_base:
  root_obs: *root_obs
  obs_training_dataset: *obs_ffhq_r1024
#  obs_training_dataset: *obs_ffhq_r64
  obs_inception_v3: *obs_inception_v3
  G_cfg: *G_cfg
  G_kwargs: *G_kwargs
  D_cfg: *D_cfg
  D_renderer_cfg: *D_renderer_cfg
  # optims
  G_lr_render: 2.e-5
  G_lr_decoder: 0.002
  D_lr_render: 2.e-4
  D_lr_decoder: 0.002
  # args
  total_iters: 200000
  ema_start: 1000
  batch: 4
  chunk: 4
  expname: ffhq1024x1024
  size: 1024
  tl_finetune: false
  finetune_dir: "results/StyleSDF-exp/train_volume_render_ffhq/train_volume_render-20220325_102346_871/ckptdir/01"
  # train
  d_reg_every: 15
  g_reg_every: 5
#  d_reg_every: 16
#  g_reg_every: 4
  path_regularize: 2
  N_rays_forward: null
  N_rays_grad: null
  N_samples_forward: null
  fade_D: true
  fade_steps: 10000
  init_renderer: true
  init_renderer_ckpt: null
#  init_renderer_ckpt: "results/StyleSDF-exp/train_cips3d_ffhq/train_r64-20220331_224622_038/ckptdir/G_sdf_init.pth"
  grad_clip: 20.
  warmup_iters: -1
  num_workers: 0
  # loss
  lambda_gp: 10.
  lambda_pose: 15.
  lambda_eikonal: 0.1
  lambda_min_surf: 0.05
  min_surf_beta: 100.
  # log
  log_txt_every: 10
  log_ckpt_every: 500
  log_N_row: 8
  log_N_col: 8
  # eval
  batch_gpu: 4
  N_gen_images_eval: 2048
  N_real_images_eval: 2048
  del_fid_real_images: true
  kid: false

train_r64:
  base: train_base
  obs_training_dataset: *obs_ffhq_r64
  G_cfg:
    enable_decoder: true
    freeze_renderer: false
#    renderer_detach: true
    renderer_detach: false
    predict_rgb_residual: false
    renderer_cfg:
      N_layers_renderer: 2
    decoder_cfg:
      upsample_list: []
  G_kwargs:
    cam_cfg:
      img_size: 64
  D_cfg:
    pretrained_size: null
  D_renderer_cfg:
    pretrained_size: -1
  init_renderer: true
#  init_renderer_ckpt: "results/StyleSDF-exp/train_cips3d_ffhq/train_r64-20220331_224622_038/ckptdir/G_sdf_init.pth"
  tl_finetune: true
  finetune_dir: "../bucket_3690/results/StyleSDF-exp/train_cips3d_ffhq/train_r64-20220409_172050_669/ckptdir/resume"
  total_iters: 200000
  ema_start: 1000
  N_rays_forward: null
  N_rays_grad: null
  N_samples_forward: null
  eikonal_reg: true
#  eikonal_reg: false
  sdf_reg: true
  g_reg_every: 5
#  g_reg_every: -1 # path_reg false
  batch_gpu: 32
  warmup_iters: 10000
  cam_img_size: 64
  gen_img_size: 64
  data_img_size: 64


train_r256:
  base: train_base
  obs_training_dataset: *obs_ffhq_r256
  G_cfg:
    enable_decoder: true
#    freeze_renderer: false
#    renderer_detach: false
    freeze_renderer: true
    renderer_detach: true
    predict_rgb_residual: false
    renderer_cfg:
      N_layers_renderer: 2
    decoder_cfg:
      upsample_list: [128, 256]
  G_kwargs:
    cam_cfg:
      img_size: 64
  D_cfg:
    pretrained_size: 64
  D_renderer_cfg:
    pretrained_size: -1
  init_renderer: false
  tl_finetune: true
  finetune_dir: "../bucket_3690/results/StyleSDF-exp/train_cips3d_ffhq_v3/train_r64-20220411_105857_803/ckptdir/resume"
  total_iters: 800000
  ema_start: 1000
  N_rays_forward: null
  N_rays_grad: null
  N_samples_forward: null
#  eikonal_reg: true
  eikonal_reg: false
  sdf_reg: false
  g_reg_every: 5
#  g_reg_every: -1 # path_reg false
  batch_gpu: 2
  warmup_iters: 10000
  cam_img_size: 64
  gen_img_size: 256 # train patch size
  data_img_size: 256
#  sample_mode: 'patch'

train_r256_ks3:
  base: train_base
  obs_training_dataset: *obs_ffhq_r256
  G_cfg:
    enable_decoder: true
#    freeze_renderer: false
    freeze_renderer: true
    renderer_detach: true
    predict_rgb_residual: false
    renderer_cfg:
      N_layers_renderer: 2
    decoder_cfg:
      upsample_list: [128, 256]
      kernel_size: 3
  G_kwargs:
    cam_cfg:
      img_size: 64
  D_cfg:
    pretrained_size: 64
  D_renderer_cfg:
    pretrained_size: -1
  init_renderer: false
  tl_finetune: true
  finetune_dir: "../bucket_3690/results/StyleSDF-exp/train_cips3d_ffhq_v3/train_r64-20220411_133429_061/ckptdir/resume"
  total_iters: 800000
  ema_start: 1000
  N_rays_forward: null
  N_rays_grad: null
  N_samples_forward: null
#  eikonal_reg: true
  eikonal_reg: false
  sdf_reg: false
  g_reg_every: 5
#  g_reg_every: -1 # path_reg false
  batch_gpu: 2
  warmup_iters: 10000
  cam_img_size: 64
  gen_img_size: 256 # train patch size
  data_img_size: 256
#  sample_mode: 'patch'

train_r256_r64:
  base: train_base
  obs_training_dataset: *obs_ffhq_r256
  G_cfg:
    enable_decoder: true
    freeze_renderer: false
    renderer_detach: false
#    freeze_renderer: true
#    renderer_detach: true
    predict_rgb_residual: false
    renderer_cfg:
      N_layers_renderer: 2
    decoder_cfg:
      upsample_list: [128, 256]
  G_kwargs:
    cam_cfg:
      img_size: 64
  D_cfg:
    pretrained_size: 64
  D_renderer_cfg:
    pretrained_size: -1
  init_renderer: false
  tl_finetune: true
  finetune_dir: "../bucket_3690/results/StyleSDF-exp/train_cips3d_ffhq_v3/train_r64-20220411_105857_803/ckptdir/resume"
  total_iters: 800000
  ema_start: 1000
  N_rays_forward: null
  N_rays_grad: null
  N_samples_forward: null
  eikonal_reg: true
  sdf_reg: true
#  eikonal_reg: false
#  sdf_reg: false
  g_reg_every: 5
#  g_reg_every: -1 # path_reg false
  batch_gpu: 2
  warmup_iters: 10000
  cam_img_size: 64
  gen_img_size: 256 # train patch size
  data_img_size: 256
#  sample_mode: 'patch'


train_r1024:
  base: train_base
  obs_training_dataset: *obs_ffhq_r1024
  G_cfg:
    enable_decoder: true
    freeze_renderer: true
    renderer_detach: true
    predict_rgb_residual: false
    renderer_cfg:
      N_layers_renderer: 2
    decoder_cfg:
      upsample_list: [128, 256, 512, 1024]
  G_kwargs:
    cam_cfg:
      img_size: 64
  D_cfg:
    pretrained_size: 64
  D_renderer_cfg:
    pretrained_size: -1
  init_renderer: false
  tl_finetune: true
  finetune_dir: "../bucket_3690/results/StyleSDF-exp/train_cips3d_ffhq/train_r64-20220409_172050_669/ckptdir/resume"
  total_iters: 800000
  ema_start: 1000
  N_rays_forward: null
  N_rays_grad: null
  N_samples_forward: null
#  eikonal_reg: true
  eikonal_reg: false
  sdf_reg: false
  g_reg_every: 5
#  g_reg_every: -1 # path_reg false
  batch_gpu: 2
  warmup_iters: 10000
  cam_img_size: 64
  gen_img_size: 1024 # train patch size
  data_img_size: 1024
#  sample_mode: 'patch'

train_r1024_ks3:
  base: train_base
  obs_training_dataset: *obs_ffhq_r1024
  G_cfg:
    enable_decoder: true
    freeze_renderer: true
    renderer_detach: true
    predict_rgb_residual: false
    renderer_cfg:
      N_layers_renderer: 2
    decoder_cfg:
      upsample_list: [128, 256, 512, 1024]
      kernel_size: 3
  G_kwargs:
    cam_cfg:
      img_size: 64
  D_cfg:
    pretrained_size: 64
  D_renderer_cfg:
    pretrained_size: -1
  init_renderer: false
  tl_finetune: true
  finetune_dir: "../bucket_3690/results/StyleSDF-exp/train_cips3d_ffhq/train_r64-20220409_172050_669/ckptdir/resume"
  total_iters: 800000
  ema_start: 1000
  N_rays_forward: null
  N_rays_grad: null
  N_samples_forward: null
#  eikonal_reg: true
  eikonal_reg: false
  sdf_reg: false
  g_reg_every: 5
#  g_reg_every: -1 # path_reg false
  batch_gpu: 2
  warmup_iters: 10000
  cam_img_size: 64
  gen_img_size: 1024 # train patch size
  data_img_size: 1024
#  sample_mode: 'patch'

train_r1024_r64_ks1:
  base: train_base
  obs_training_dataset: *obs_ffhq_r1024
  G_cfg:
    enable_decoder: true
#    freeze_renderer: true
#    renderer_detach: true
    freeze_renderer: false
    renderer_detach: false
    predict_rgb_residual: false
    renderer_cfg:
      N_layers_renderer: 2
    decoder_cfg:
      upsample_list: [128, 256, 512, 1024]
      kernel_size: 1
  G_kwargs:
    cam_cfg:
      img_size: 64
  D_cfg:
    pretrained_size: null
  D_renderer_cfg:
    pretrained_size: null
  init_renderer: true
  tl_finetune: false
#  tl_finetune: true
#  finetune_dir: "../bucket_3690/results/StyleSDF-exp/train_cips3d_ffhq_v3/train_r1024_r64_ks1-20220411_235145_682/ckptdir/resume"
  total_iters: 800000
  ema_start: 1000
  N_rays_forward: null
  N_rays_grad: null
  N_samples_forward: null
  eikonal_reg: true
  sdf_reg: true
#  eikonal_reg: false
#  sdf_reg: false
  g_reg_every: 5
#  g_reg_every: -1 # path_reg false
  batch_gpu: 4
  warmup_iters: 10000
  cam_img_size: 64
  gen_img_size: 1024 # train patch size
  data_img_size: 1024
#  sample_mode: 'patch'

train_r256_r64_ks1:
  base: train_base
  obs_training_dataset: *obs_ffhq_r256
  G_cfg:
    enable_decoder: true
#    freeze_renderer: true
#    renderer_detach: true
    freeze_renderer: false
    renderer_detach: false
    predict_rgb_residual: false
    renderer_cfg:
      N_layers_renderer: 2
    decoder_cfg:
      upsample_list: [128, 256]
      kernel_size: 1
  G_kwargs:
    cam_cfg:
      img_size: 64
  D_cfg:
    pretrained_size: null
  D_renderer_cfg:
    pretrained_size: null
  init_renderer: true
  tl_finetune: false
#  finetune_dir: "../bucket_3690/results/StyleSDF-exp/train_cips3d_ffhq_v3/train_r64-20220411_105857_803/ckptdir/resume"
  total_iters: 800000
  ema_start: 1000
  N_rays_forward: null
  N_rays_grad: null
  N_samples_forward: null
  eikonal_reg: true
  sdf_reg: true
#  eikonal_reg: false
#  sdf_reg: false
  g_reg_every: 5
#  g_reg_every: -1 # path_reg false
  batch_gpu: 4
  warmup_iters: 10000
  cam_img_size: 64
  gen_img_size: 256 # train patch size
  data_img_size: 256
#  sample_mode: 'patch'

train_r256_r32_ks1:
  base: train_base
  obs_training_dataset: *obs_ffhq_r256
  G_cfg:
    enable_decoder: true
#    freeze_renderer: true
#    renderer_detach: true
    freeze_renderer: false
    renderer_detach: false
    predict_rgb_residual: false
    renderer_cfg:
      N_layers_renderer: 2
      hidden_dim: 256
    decoder_cfg:
      upsample_list: [128, 256, 512]
      kernel_size: 1
  G_kwargs:
    cam_cfg:
      img_size: 32
  D_cfg:
    pretrained_size: null
  D_renderer_cfg:
    pretrained_size: null
  init_renderer: true
  init_iters: 20000
  tl_finetune: false
#  finetune_dir: "../bucket_3690/results/StyleSDF-exp/train_cips3d_ffhq_v3/train_r64-20220411_105857_803/ckptdir/resume"
  total_iters: 800000
  ema_start: 1000
  N_rays_forward: null
  N_rays_grad: null
  N_samples_forward: null
  eikonal_reg: true
  sdf_reg: true
#  eikonal_reg: false
#  sdf_reg: false
  g_reg_every: 5
#  g_reg_every: -1 # path_reg false
  batch_gpu: 4
  warmup_iters: 20000
  cam_img_size: 32
  gen_img_size: 256 # train patch size
  data_img_size: 256
#  sample_mode: 'patch'
  fade_steps: 20000


finetune_r1024_r64_ks1:
  base: train_r1024_r64_ks1
  obs_training_dataset: *obs_afhq_r1024
  G_cfg:
    register_modules:
      - "exp.cips3d.models.model_v3_finetune"
    name: "exp.cips3d.models.model_v3_finetune.Generator"
    enable_decoder: true
    freeze_renderer: true
    freeze_decoder_mapping: true
    renderer_detach: true
    predict_rgb_residual: false
    decoder_cfg:
      kernel_size: 1
  D_cfg:
    pretrained_size: -1
    diffaug: true
  D_renderer_cfg:
    pretrained_size: -1
  tl_finetune: true
  finetune_dir: "results/StyleSDF-exp/train_cips3d_ffhq_v3/train_r1024_r64_ks1-20220411_235145_682/ckptdir/resume"
#  finetune_dir: "results/StyleSDF-exp/train_cips3d_ffhq_v3/train_r1024_r64_ks1-20220412_201401_070/ckptdir/resume"
  g_reg_every: 5
#  g_reg_every: -1 # path_reg false

finetune_r1024_r64_ks1_metfaces:
  base: finetune_r1024_r64_ks1
  obs_training_dataset: *obs_metfaces_r1024
  finetune_dir: "results/StyleSDF-exp/train_cips3d_ffhq_v3/train_r1024_r64_ks1-20220411_235145_682/ckptdir/resume_4.11"

finetune_r1024_r64_ks1_afhq:
  base: finetune_r1024_r64_ks1
  obs_training_dataset: *obs_afhq_r1024
  finetune_dir: "results/StyleSDF-exp/train_cips3d_ffhq_v3/train_r1024_r64_ks1-20220411_235145_682/ckptdir/resume_4.11"

finetune_r1024_r64_ks1_bitmojifaces:
  base: finetune_r1024_r64_ks1
  obs_training_dataset: *obs_bitmojifaces_r1024
  finetune_dir: "results/StyleSDF-exp/train_cips3d_ffhq_v3/train_r1024_r64_ks1-20220411_235145_682/ckptdir/resume_4.11"

finetune_r1024_r64_ks1_disney:
  base: finetune_r1024_r64_ks1
  obs_training_dataset: *obs_disney_r1024
  finetune_dir: "pretrained/ffhq_r1024_inversion"
  ema_start: 50
  batch_gpu_eval: 8

finetune_r1024_r64_ks1_photo2cartoon:
  base: finetune_r1024_r64_ks1
  obs_training_dataset: *obs_photo2cartoon_r1024
  finetune_dir: "results/StyleSDF-exp/train_cips3d_ffhq_v3/train_r1024_r64_ks1-20220411_235145_682/ckptdir/resume_4.11"
  ema_start: 50
  batch_gpu_eval: 8

_setup_evaluation:
  base: train_base
  N_real_images_eval: 2048
  del_fid_real_images: true

eval_fid_r256:
  base: train_r256_r64_ks1
#  network_pkl: "results/StyleSDF-exp/train_cips3d_ffhq_v3/train_r256_r64_ks1-20220414_094821_786/ckptdir/resume/G_ema.pth"
#  network_pkl: "results/StyleSDF-exp/train_cips3d_ffhq_v3/train_r256_r64_ks1-20220414_094821_786/ckptdir/best_fid/G_ema.pth"
#  network_pkl: "results/StyleSDF-exp/train_cips3d_ffhq_v3/train_r256_r64_ks1-20220414_095456_981/ckptdir/resume/G_ema.pth"
  network_pkl: "results/StyleSDF-exp/train_cips3d_ffhq_v3/train_r256_r64_ks1-20220414_095456_981/ckptdir/best_fid/G_ema.pth"
  batch_gpu: 4
  N_gen_images_eval: 2048
  N_real_images_eval: 2048
  del_fid_real_images: true
  kid: false
  real_dir: "cache_pretrained/ffhq_r256_5w/"
#  real_dir: null
#  fake_dir: null
#  fake_dir: "cache_pretrained/gen_ffhq_r256_5w_stylegan2"
#  fake_dir: "cache_pretrained/gen_ffhq_r256_5w_projected_gan"
#  fake_dir: "cache_pretrained/gen_ffhq256_5w_cips"
#  fake_dir: "cache_pretrained/gen_ffhq_r256_5w_styleswin"
  fake_dir: "cache_pretrained//gen_ffhq_r256_5w_styleganxl"
  overwrite: false
  data_img_size: 256

eval_fid_r1024:
  base: train_r1024_r64_ks1
#  network_pkl: "results/StyleSDF-exp/train_cips3d_ffhq_v3/train_r1024_r64_ks1-20220411_235145_682/ckptdir/resume/G_ema.pth"
#  network_pkl: "results/StyleSDF-exp/train_cips3d_ffhq_v3/train_r1024_r64_ks1-20220411_235145_682/ckptdir/resume_4.11/G_ema.pth"
  network_pkl: "results/StyleSDF-exp/train_cips3d_ffhq_v3/train_r1024_r64_ks1-20220411_235145_682/ckptdir/best_fid/G_ema.pth"
#  network_pkl: "results/StyleSDF-exp/train_cips3d_ffhq_v3/train_r1024_r64_ks1-20220412_201401_070/ckptdir/resume/G_ema.pth"
#  network_pkl: "results/StyleSDF-exp/train_cips3d_ffhq_v3/train_r1024_r64_ks1-20220412_201401_070/ckptdir/best_fid/G_ema.pth"
  batch_gpu: 4
  N_gen_images_eval: 2048
  N_real_images_eval: 2048
  del_fid_real_images: true
  kid: false
  real_dir: "cache_pretrained/ffhq_r1024_5w/"
#  real_dir: null
#  fake_dir: null
#  fake_dir: "cache_pretrained/gen_ffhq_r1024_5w_stylegan2"
#  fake_dir: "cache_pretrained/gen_ffhq1024_r_5w_stylegan3"
#  fake_dir: "cache_pretrained/gen_ffhq1024_t_5w_stylegan3"
#  fake_dir: "cache_pretrained/gen_ffhq1024_5w_cips"
#  fake_dir: "cache_pretrained//gen_ffhq1024_5w_styleswin"
  fake_dir: "cache_pretrained//gen_ffhq_r1024_5w_styleganxl"
  overwrite: false
  data_img_size: 1024

_gen_images_ffhq:
  base: train_base
  G_kwargs:
    cam_cfg:
      azim_range: 0
      elev_range: 0
  network_pkl: *network_pkl
  default_network_pkl: "FFHQ_r1024_ks1"
  N_gen_images_eval: 1000
  batch_gpu: 4
  truncation: 0.7
  frontal: true

_gen_images_disney:
  base: train_base
  G_kwargs:
    cam_cfg:
      azim_range: 0
      elev_range: 0
  network_pkl: *network_pkl
  default_network_pkl: "FFHQ_disney"
  N_gen_images_eval: 1000
  batch_gpu: 4
  truncation: 0.7

_gen_images_metfaces:
  base: train_base
  G_kwargs:
    cam_cfg:
      azim_range: 0
      elev_range: 0
  network_pkl: *network_pkl
  default_network_pkl: "FFHQ_MetFaces_ks1"
  N_gen_images_eval: 1000
  batch_gpu: 4
  truncation: 0.7

_render_video_web:
  root_obs: *root_obs
  port: 8501
  sidebar:
    sidebar_name: "show_video"
  model_cfg:
    register_modules:
      - exp.cips3d.models.render_video_web_v3
    name: exp.cips3d.models.render_video_web_v3.STModel
  mode:
    - _render_video_web
  _render_video_web:
    G_kwargs: *G_kwargs
    network_pkl: *network_pkl
    default_network_pkl: FFHQ_r1024_ks1
    N_frames: 40
    fps: 20
    hd_video: true
    view_mode:
      - circle
      - yaw
    default_view_mode: yaw
    seeds:
      - 123
      - 8666477
#      - 2397456
#      - 2910468
#      - 1317869

    truncation_ratio: 0.5
    img_size: 64
    upsample_list: [128, 256, 512, 1024]
    N_samples: 128
    zero_noise_bufs: false
    light_location: [0, 0, 5]
#    static_viewdirs: true
#    saved_w_file: "results/train_cips3d_ffhq_v3/_flip_inversion_web/exp/0000/01180_w.pth"
    saved_w_file: ""
    w_gallery:
      tian: "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/Qi_head_aligned_00/Qi_head_aligned_00_w.pth"
      '51329': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/51329/51329_w.pth"
      '43737': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/43737/43737_w.pth"
      '37592': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/37592/37592_w.pth"
      '57393': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/57393/57393_w.pth"
      '57393_no_flip': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/57393_no_flip/57393_w.pth"
      '57393_no_campose': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/57393_no_campose/57393_w.pth"
      '57864': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/57864/57864_w.pth"
      '57847': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/57847/57847_w.pth"
      'test': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/test/test_w.pth"
      'panda': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/panda/panda_w.pth"
      'face_hair': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/face_hair/face_hair_w.pth"

    default_w_gallery: '57393'
    use_w_gallery: false
    truncation_content: 1.
    interp_indices: [0, 1, 2, 3, 4, 5, 6, 7]
    interp_conv_in: false
#    azim_range: [-1.57, 1.57]
#    azim_range: [-1., 1.]
    azim_range: [-0.77, 0.77]
    elev_range: [0, 0]

  expname: ffhq1024x1024
  size: 1024
  identities: 4

_interpolate_z_web:
  root_obs: *root_obs
  port: 8501
  sidebar:
    sidebar_name: "show_video"
  model_cfg:
    register_modules:
      - exp.cips3d.models.render_video_web_v3
    name: exp.cips3d.models.render_video_web_v3.STModel
  mode:
    - _interpolate_z_web
  _interpolate_z_web:
    G_kwargs: *G_kwargs
    network_pkl: *network_pkl
    default_network_pkl: FFHQ_r1024_ks1
    N_samples: 5
    N_step: 20
    z_mode:
      - shape
      - app
      - style
    default_z_mode: shape
    interp_mode:
      - lerp
      - slerp
    azim: 0.
    elev: 0.
    fov: 6.
    truncation_ratio: 0.5
    fps: 10
    hd_video: true
    seeds:
      - 123

_inversion_web:
  root_obs: *root_obs
  port: 8501
  sidebar:
    sidebar_name: "show_video"
  model_cfg:
    register_modules:
      - exp.cips3d.models.render_video_web_v3
    name: exp.cips3d.models.render_video_web_v3.STModel
  mode:
    - _inversion_web
  _inversion_web:
    perceptual_cfg:
      register_modules:
      - exp.cips3d.models.vgg_per_loss
      name: exp.cips3d.models.vgg_per_loss.VGG16ConvLoss
      model_name: vgg16_conv
      downsample_size: -1
      use_stat_loss: false
      layers:
      - features_2
      - features_7
      - features_14
      - features_21
      - features_28
      loss_w_dict:
        features_2: 0.0002
        features_7: 0.0001
        features_14: 0.0001
        features_21: 0.0002
        features_28: 0.0005
    image_list_files:
      aligned_faces:
        image_list_file: "datasets/aligned_faces"
      tian:
        image_list_file: "datasets/tian/aligned.txt"
    network_pkl: *network_pkl
    default_network_pkl: FFHQ_r1024_ks1
    N_samples: 5
    N_step: 20
    z_mode:
      - shape
      - app
      - style
    default_z_mode: shape
    interp_mode:
      - lerp
      - slerp
    azim: 0.
    elev: 0.
    fov: 6.
    truncation_ratio: 0.5
    fps: 10
    hd_video: true
    seeds:
      - 123

    lr_cam: 0.04
    lr_render_w: 0.01
    lr_decoder_w: 0.01
    lr_decoder_params: 0.002
    lr_noise: 0.001

    rgb_weight: 1.
    thumb_weight: 50.
    mse_weight: 0.
    regularize_noise_weight: 100000

    optim_cam: true
    optim_render_w: true
    optim_decoder_w: true
    optim_decoder_params: true
    optim_noise_bufs: false
    zero_noise_bufs: false

    N_steps_pose: 200
    N_steps_app: 800
    N_steps_multiview: 0
    truncation_psi: 0.
    perceptual_layers_multiview:
#      - features_2
#      - features_7
      - features_14
      - features_21
      - features_28

_flip_inversion_web:
  root_obs: *root_obs
  port: 8501
  sidebar:
    sidebar_name: "show_video"
  model_cfg:
    register_modules:
      - exp.cips3d.models.render_video_web_v3
    name: exp.cips3d.models.render_video_web_v3.STModel
  mode:
    - _flip_inversion_web
  _flip_inversion_web:
    perceptual_cfg:
      register_modules:
      - exp.cips3d.models.vgg_per_loss
      name: exp.cips3d.models.vgg_per_loss.VGG16ConvLoss
      model_name: vgg16_conv
      downsample_size: -1
      use_stat_loss: false
      layers:
      - features_2
      - features_7
      - features_14
      - features_21
      - features_28
      loss_w_dict:
        features_2: 0.0002
        features_7: 0.0001
        features_14: 0.0001
        features_21: 0.0002
        features_28: 0.0005
    image_list_files:
      aligned_faces:
        image_list_file: "datasets/aligned_faces"
      disney:
        image_list_file: "datasets/disney"
      tian:
        image_list_file: "datasets/tian/aligned.txt"
    network_pkl: *network_pkl
    network_pkl_choice:
      - v9_ffhq_r64
      - FFHQ_r1024_ks1
      - FFHQ_r1024_ks3
      - FFHQ_disney
      - FFHQ_r1024_ks1_d
      - FFHQ_MetFaces_ks1
    default_network_pkl: FFHQ_r1024_ks1
    N_samples: 5
    N_step: 20
    z_mode:
      - shape
      - app
      - style
    default_z_mode: shape
    interp_mode:
      - lerp
      - slerp
    azim: 0.
    elev: 0.
    fov: 6.
    truncation_ratio: 0.5
    fps: 10
    hd_video: true
    seeds:
      - 123

    lr_cam: 0.04
    lr_render_w: 0.01
    lr_decoder_w: 0.01
    lr_decoder_params: 0.005
    lr_noise: 0.001

    rgb_weight: 1.
    thumb_weight: 50.
    mse_weight: 0.
    regularize_noise_weight: 100000

    optim_cam: true
    optim_render_w: true
    optim_render_params: false
    optim_decoder_w: true
    optim_decoder_params: true
    optim_noise_bufs: false
    zero_noise_bufs: false

    bs_cam: 2
    bs_render: 1
    bs_decoder: 2

    N_steps_pose: 200
    N_steps_app: 1000
    N_steps_multiview: 0
    truncation_psi: 1.
    mask_background: true
    flip_w_decoder_every: 10

_render_multi_view_web:
  root_obs: *root_obs
  port: 8501
  sidebar:
    sidebar_name: "show_video"
  model_cfg:
    register_modules:
      - exp.cips3d.models.render_video_web_v3
    name: exp.cips3d.models.render_video_web_v3.STModel
  mode:
    - _render_multi_view_web
  _render_multi_view_web:
    N_frames: 40
    fps: 20
    hd_video: true

    view_mode:
      - yaw
      - circle
    default_view_mode: yaw
#    azim_range: [-1.57, 1.57]
    azim_range: [-1., 1.]
    elev: 0.
    circle:
      azim: 0.25
      elev: 0.25

    seeds:
      - 4892508
      - 7355011
      - 4297557
      - 1807266
      - 5457953
      - 6588477
      - 7021150
      - 6210399
      - 8666477
    target_truncation: 0.8
    zero_noise_bufs: true

    network_pkl: *network_pkl
    default_network_pkl: FFHQ_r1024_ks1
    N_samples: 128

    saved_w_file: ""
    w_gallery:
      tian: "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/Qi_head_aligned_00/Qi_head_aligned_00_w.pth"
      '01067': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/01067/01067_w.pth"
      '01180': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/01180/01180_w.pth"
      '30169': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/30169/30169_w.pth"
      '30169_every2': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/30169_every2/30169_w.pth"
      '30169_noflip': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/30169_noflip/30169_w.pth"
      '30386': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/30386/30386_w.pth"
      '30386_symm': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/30386_symm/30386_w.pth"
      '30576': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/30576/30576_w.pth"
      '51329': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/51329/51329_w.pth"
      '43737': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/43737/43737_w.pth"
      '37592': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/37592/37592_w.pth"
      '57193': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/57193/57193_w.pth"
      '57393': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/57393/57393_w.pth"
      '57393_no_flip': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/57393_no_flip/57393_w.pth"
      '57393_no_campose': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/57393_no_campose/57393_w.pth"
      '57393_all': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/57393_all/57393_w.pth"
      '57864': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/57864/57864_w.pth"
      '57847': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/57847/57847_w.pth"
      '57847_all': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/57847_all/57847_w.pth"
      '63380': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/63380/63380_w.pth"
      'test': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/test/test_w.pth"
      'panda': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/panda/panda_w.pth"
      'panda_align': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/panda_align/panda_w.pth"
      'panda_align_symm': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/panda_align_symm/panda_w.pth"
      'robert': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/robert/robert_w.pth"
      'IronMan': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/IronMan/IronMan_w.pth"
      'robert_ironman': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/robert_ironman/robert_ironman_w.pth"
      'bear': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/bear/bear_w.pth"
      'spiderman': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/spiderman/spiderman_w.pth"
      'Vermeer': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/Vermeer/Vermeer_w.pth"
      'obama': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/obama/obama_w.pth"
      'anne_hathaway': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/anne_hathaway/anne_hathaway_w.pth"
      'park_min_young': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/park_min_young/park_min_young_w.pth"
      'abe': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/abe/abe_w.pth"

      'disney_486_02': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/disney_486_02/Cartoons_00486_02_w.pth"
      'disney_486_02_symm': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/disney_486_02_symm/Cartoons_00486_02_w.pth"

    default_w_gallery: '57847'
    use_w_gallery: true

    target_saved_w_file: ""
    target_w_gallery:
      '486_02': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/Cartoons_00486_02/Cartoons_00486_02_w.pth"
      '486_02_w': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/Cartoons_00486_02_w/Cartoons_00486_02_w.pth"
      '2_01_w': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/Cartoons_00002_01_w/Cartoons_00002_01_w.pth"
      '4_01_w': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/Cartoons_00004_01_w/Cartoons_00004_01_w.pth"

    target_default_w_gallery: '486_02_w'
    target_use_w_gallery: false
    target_inverted_truncation: 0.6

    interp_w_shape_weights_dict:
      '0': 0.
      '1': 0.
      '2': 0.

    interp_w_app_weights_dict0:
      '0': 0.
      '1': 0.
      '2': 0.
      '3': 0.
      '4': 0.
      '5': 0.
      '6': 0.
      '7': 0.
    interp_w_app_weights_dict1:
      '8': 1.
      '9': 1.
      '10': 1.
      '11': 1.
      '12': 1.
      '13': 1.
      '14': 1.
      '15': 1.
      '16': 1.
      '17': 1.

    interp_conv_weights_dict0:
      'conv1': 0.
      '0': 0.
      '1': 0.
      '2': 0.
      '3': 0.
      '4': 0.
      '5': 0.
      '6': 0.
      '7': 1.
    interp_conv_weights_dict1:
      '8': 1.
      '9': 1.
      '10': 1.
      '11': 1.
      '12': 1.
      '13': 1.
      '14': 1.
      '15': 1.

    interp_to_rgb_weights_dict:
      'to_rgb1': 0.
      '0': 0.
      '1': 0.
      '2': 0.
      '3': 1.
      '4': 1.
      '5': 1.
      '6': 1.
      '7': 1.


_interpolate_decoder_web:
  root_obs: *root_obs
  port: 8501
  sidebar:
    sidebar_name: "show_video"
  model_cfg:
    register_modules:
      - exp.cips3d.models.render_video_web_v3
    name: exp.cips3d.models.render_video_web_v3.STModel
  mode:
    - _interpolate_decoder_web
  _interpolate_decoder_web:
    N_frames: 40
    fps: 20
    hd_video: true

    view_mode:
      - yaw
      - circle
    default_view_mode: yaw
#    azim_range: [-1.57, 1.57]
    azim_range: [-1., 1.]
    elev: 0.
    circle:
      azim: 0.25
      elev: 0.25

    seeds:
      - 4892508
      - 7355011
      - 4297557
      - 1807266
      - 5457953
      - 6588477
      - 7021150
      - 6210399
      - 8666477
    target_truncation: 0.8
    zero_noise_bufs: true

    network_pkl: *network_pkl
    default_network_pkl: FFHQ_disney
    N_samples: 128

    saved_w_file: ""
    w_gallery:
      tian: "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/Qi_head_aligned_00/Qi_head_aligned_00_w.pth"
      '01067': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/01067/01067_w.pth"
      '01180': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/01180/01180_w.pth"
      '30169': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/30169/30169_w.pth"
      '30169_every2': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/30169_every2/30169_w.pth"
      '30169_noflip': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/30169_noflip/30169_w.pth"
      '30386': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/30386/30386_w.pth"
      '30386_symm': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/30386_symm/30386_w.pth"
      '30576': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/30576/30576_w.pth"
      '51329': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/51329/51329_w.pth"
      '43737': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/43737/43737_w.pth"
      '37592': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/37592/37592_w.pth"
      '57193': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/57193/57193_w.pth"
      '57393': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/57393/57393_w.pth"
      '57393_no_flip': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/57393_no_flip/57393_w.pth"
      '57393_no_campose': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/57393_no_campose/57393_w.pth"
      '57393_all': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/57393_all/57393_w.pth"
      '57864': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/57864/57864_w.pth"
      '57847': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/57847/57847_w.pth"
      '57847_all': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/57847_all/57847_w.pth"
      '63380': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/63380/63380_w.pth"
      'test': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/test/test_w.pth"
      'panda': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/panda/panda_w.pth"
      'panda_align': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/panda_align/panda_w.pth"
      'panda_align_symm': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/panda_align_symm/panda_w.pth"
      'robert': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/robert/robert_w.pth"
      'IronMan': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/IronMan/IronMan_w.pth"
      'robert_ironman': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/robert_ironman/robert_ironman_w.pth"
      'bear': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/bear/bear_w.pth"
      'spiderman': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/spiderman/spiderman_w.pth"
      'Vermeer': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/Vermeer/Vermeer_w.pth"
      'obama': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/obama/obama_w.pth"
      'anne_hathaway': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/anne_hathaway/anne_hathaway_w.pth"
      'park_min_young': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/park_min_young/park_min_young_w.pth"
      'abe': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/abe/abe_w.pth"

      'disney_486_02': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/disney_486_02/Cartoons_00486_02_w.pth"
      'disney_486_02_symm': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/disney_486_02_symm/Cartoons_00486_02_w.pth"

    default_w_gallery: '57847'
    use_w_gallery: true

    target_saved_w_file: ""
    target_w_gallery:
      '486_02': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/Cartoons_00486_02/Cartoons_00486_02_w.pth"
      '486_02_w': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/Cartoons_00486_02_w/Cartoons_00486_02_w.pth"
      '2_01_w': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/Cartoons_00002_01_w/Cartoons_00002_01_w.pth"
      '4_01_w': "../bucket_3690/cache_pretrained/CIPS-3Dpp/proj_ws/Cartoons_00004_01_w/Cartoons_00004_01_w.pth"

    target_default_w_gallery: '486_02_w'
    target_use_w_gallery: false
    target_inverted_truncation: 0.6

    interp_w_shape_weights_dict:
      '0': 0.
      '1': 0.
      '2': 0.

    interp_w_app_weights_dict0:
      '0': 0.
      '1': 0.
      '2': 0.
      '3': 0.
      '4': 0.
      '5': 0.
      '6': 0.
      '7': 0.
    interp_w_app_weights_dict1:
      '8': 1.
      '9': 1.
      '10': 1.
      '11': 1.
      '12': 1.
      '13': 1.
      '14': 1.
      '15': 1.
      '16': 1.
      '17': 1.

    interp_conv_weights_dict0:
      'conv1': 0.
      '0': 0.
      '1': 0.
      '2': 0.
      '3': 0.
      '4': 0.
      '5': 0.
      '6': 0.
      '7': 1.
    interp_conv_weights_dict1:
      '8': 1.
      '9': 1.
      '10': 1.
      '11': 1.
      '12': 1.
      '13': 1.
      '14': 1.
      '15': 1.

    interp_to_rgb_weights_dict:
      'to_rgb1': 0.
      '0': 0.
      '1': 0.
      '2': 0.
      '3': 1.
      '4': 1.
      '5': 1.
      '6': 1.
      '7': 1.

_sample_multi_view_web:
  root_obs: *root_obs
  port: 8501
  sidebar:
    sidebar_name: "show_video"
  model_cfg:
    register_modules:
      - exp.cips3d.models.render_video_web_v3
    name: exp.cips3d.models.render_video_web_v3.STModel
  mode:
    - _sample_multi_view_web
  _sample_multi_view_web:
    N_frames: 40
    fps: 20
    hd_video: true

    truncation_ratio: 0.5
    N_samples: 128
    zero_noise_bufs: false
    light_location: [ 0, 0, 5 ]
    show_trajectory: true

    seeds:
      - 8936799
      - 1422866
      - 1010682
      - 4921831
#      - 8666477
#      - 5949945
#      - 5623520
#      - 2397456
#      - 2910468
#      - 1317869
    view_mode:
      - yaw
      - translate_rotate
      - circle
    default_view_mode: yaw
#    azim_range: [-1.57, 1.57]
#    azim_range: [-1., 1.]
    azim_range: [-0.77, 0.77]
    elev: 0.
    trans_max: 0.06
    circle:
      azim_range: 0.5
      elev_range: 0.
      fov_range: [6, 8]

    network_pkl: *network_pkl
    default_network_pkl: FFHQ_r1024_ks1

_style_mixing_web:
  root_obs: *root_obs
  port: 8501
  sidebar:
    sidebar_name: "show_video"
  model_cfg:
    register_modules:
      - exp.cips3d.models.render_video_web_v3
    name: exp.cips3d.models.render_video_web_v3.STModel
  mode:
    - _style_mixing_web
  _style_mixing_web:
    N_frames: 40
    fps: 20
    hd_video: true

    truncation_ratio: 0.5
    N_samples: 128
    zero_noise_bufs: false
    light_location: [ 0, 0, 5 ]
    show_trajectory: true

    seeds:
      - 123
      - 8666477
      - 5949945
      - 5623520
#      - 2397456
#      - 2910468
#      - 1317869
    view_mode:
      - yaw
      - translate_rotate
      - circle
    default_view_mode: yaw
#    azim_range: [-1.57, 1.57]
#    azim_range: [-1., 1.]
    azim_range: [-0.6, 0.6]
    elev: 0.8
    trans_max: 0.06

    network_pkl: *network_pkl
    default_network_pkl: carla_r256

    chunk: 1
    N_rows: 5
    N_cols: 5
    seed_list1:
      - 355578
      - 349985
      - 814530
      - 123298
      - 601068
    seed_list2:
      - 4567
      - 429091
      - 909199
      - 186895
      - 443196

_fixed_zs_multi_view_web:
  root_obs: *root_obs
  port: 8501
  sidebar:
    sidebar_name: "show_video"
  model_cfg:
    register_modules:
      - exp.cips3d.models.render_video_web_v3
    name: exp.cips3d.models.render_video_web_v3.STModel
  mode:
    - _fixed_zs_multi_view_web
  _fixed_zs_multi_view_web:
    N_frames: 40
    fps: 20
    hd_video: true

    truncation_ratio: 0.5
    N_samples: 128
    zero_noise_bufs: false
    light_location: [ 0, 0, 5 ]
    show_trajectory: true

    seeds:
      - 1010682
      - 4921831
#      - 8666477
#      - 5949945
#      - 5623520
#      - 2397456
#      - 2910468
#      - 1317869
    view_mode:
      - yaw
      - translate_rotate
      - circle
    default_view_mode: circle
#    azim_range: [-1.57, 1.57]
#    azim_range: [-1., 1.]
    azim_range: [-0.77, 0.77]
    elev: 0.
    trans_max: 0.06
    circle:
      azim_range: 0.3
      elev_range: 0.
      fov_range: [6, 10]

    network_pkl: *network_pkl
    default_network_pkl: FFHQ_r256_ks1

_flip_inversion_axis_angle_web:
  root_obs: *root_obs
  port: 8501
  sidebar:
    sidebar_name: "show_video"
  model_cfg:
    register_modules:
      - exp.cips3d.models.render_video_web_v3
    name: exp.cips3d.models.render_video_web_v3.STModel
  mode:
    - _flip_inversion_axis_angle_web
  _flip_inversion_axis_angle_web:
    perceptual_cfg:
      register_modules:
      - exp.cips3d.models.vgg_per_loss
      name: exp.cips3d.models.vgg_per_loss.VGG16ConvLoss
      model_name: vgg16_conv
      downsample_size: -1
      use_stat_loss: false
      layers:
      - features_2
      - features_7
      - features_14
      - features_21
      - features_28
      loss_w_dict:
        features_2: 0.0002
        features_7: 0.0001
        features_14: 0.0001
        features_21: 0.0002
        features_28: 0.0005
    image_list_files:
      aligned_faces:
        image_list_file: "datasets/aligned_faces"
      disney:
        image_list_file: "datasets/disney"
      tian:
        image_list_file: "datasets/tian/aligned.txt"
    network_pkl: *network_pkl
    network_pkl_choice:
      - FFHQ_r1024_ks1
      - FFHQ_r1024_ks3
      - FFHQ_disney
      - FFHQ_r1024_ks1_d
    default_network_pkl: FFHQ_r1024_ks1
    N_samples: 5
    N_step: 20
    z_mode:
      - shape
      - app
      - style
    default_z_mode: shape
    interp_mode:
      - lerp
      - slerp
    azim: 0.
    elev: 0.
    fov: 6.
    truncation_ratio: 0.5
    fps: 10
    hd_video: true
    seeds:
      - 123

    lr_cam: 0.001
    lr_render_w: 0.0
    lr_decoder_w: 0.01
    lr_decoder_params: 0.005
    lr_noise: 0.001

    rgb_weight: 1.
    thumb_weight: 50.
    mse_weight: 0.
    regularize_noise_weight: 100000

    optim_cam: true
    optim_render_w: true
    optim_render_params: false
    optim_decoder_w: true
    optim_decoder_params: true
    optim_noise_bufs: false
    zero_noise_bufs: false

    bs_cam: 2
    bs_render: 1
    bs_decoder: 2

    N_steps_pose: 200
    N_steps_app: 0
    N_steps_multiview: 0
    truncation_psi: 1.
    mask_background: true
    flip_w_decoder_every: 10
